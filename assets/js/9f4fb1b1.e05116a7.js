"use strict";(self.webpackChunknode_note=self.webpackChunknode_note||[]).push([[184],{3905:function(n,e,s){s.d(e,{Zo:function(){return o},kt:function(){return m}});var t=s(7294);function l(n,e,s){return e in n?Object.defineProperty(n,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[e]=s,n}function r(n,e){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),s.push.apply(s,t)}return s}function a(n){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?r(Object(s),!0).forEach((function(e){l(n,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(s,e))}))}return n}function i(n,e){if(null==n)return{};var s,t,l=function(n,e){if(null==n)return{};var s,t,l={},r=Object.keys(n);for(t=0;t<r.length;t++)s=r[t],e.indexOf(s)>=0||(l[s]=n[s]);return l}(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(t=0;t<r.length;t++)s=r[t],e.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(n,s)&&(l[s]=n[s])}return l}var p=t.createContext({}),c=function(n){var e=t.useContext(p),s=e;return n&&(s="function"==typeof n?n(e):a(a({},e),n)),s},o=function(n){var e=c(n.components);return t.createElement(p.Provider,{value:e},n.children)},u={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},d=t.forwardRef((function(n,e){var s=n.components,l=n.mdxType,r=n.originalType,p=n.parentName,o=i(n,["components","mdxType","originalType","parentName"]),d=c(s),m=l,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||r;return s?t.createElement(g,a(a({ref:e},o),{},{components:s})):t.createElement(g,a({ref:e},o))}));function m(n,e){var s=arguments,l=e&&e.mdxType;if("string"==typeof n||l){var r=s.length,a=new Array(r);a[0]=d;var i={};for(var p in e)hasOwnProperty.call(e,p)&&(i[p]=e[p]);i.originalType=n,i.mdxType="string"==typeof n?n:l,a[1]=i;for(var c=2;c<r;c++)a[c]=s[c];return t.createElement.apply(null,a)}return t.createElement.apply(null,s)}d.displayName="MDXCreateElement"},3189:function(n,e,s){s.r(e),s.d(e,{frontMatter:function(){return i},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return o},default:function(){return d}});var t=s(7462),l=s(3366),r=(s(7294),s(3905)),a=["components"],i={sidebar_position:2},p="\u81ea\u52a8\u5316\u6784\u5efa",c={unversionedId:"cli/grunt",id:"cli/grunt",title:"\u81ea\u52a8\u5316\u6784\u5efa",description:"\u4e00\u5207\u91cd\u590d\u5de5\u4f5c\u672c\u5e94\u81ea\u52a8\u5316",source:"@site/docs/cli/grunt.md",sourceDirName:"cli",slug:"/cli/grunt",permalink:"/node-note/docs/cli/grunt",editUrl:"https://github.com/shibin-cli/node-note/tree/master/packages/create-docusaurus/templates/shared/docs/cli/grunt.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Monorepo",permalink:"/node-note/docs/cli/monorepo"},next:{title:"Webpack4",permalink:"/node-note/docs/cli/webpack4"}},o=[{value:"\u81ea\u52a8\u5316\u6784\u5efa\u521d\u4f53\u9a8c",id:"\u81ea\u52a8\u5316\u6784\u5efa\u521d\u4f53\u9a8c",children:[],level:2},{value:"\u5e38\u7528\u7684\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u5177",id:"\u5e38\u7528\u7684\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u5177",children:[],level:2},{value:"Grunt",id:"grunt",children:[{value:"\u6807\u8bb0\u5931\u8d25\u4efb\u52a1",id:"\u6807\u8bb0\u5931\u8d25\u4efb\u52a1",children:[],level:3},{value:"Grunt\u7684\u914d\u7f6e\u65b9\u6cd5",id:"grunt\u7684\u914d\u7f6e\u65b9\u6cd5",children:[],level:3},{value:"\u591a\u76ee\u6807\u4efb\u52a1",id:"\u591a\u76ee\u6807\u4efb\u52a1",children:[],level:3},{value:"Grunt\u63d2\u4ef6\u7684\u4f7f\u7528",id:"grunt\u63d2\u4ef6\u7684\u4f7f\u7528",children:[],level:3},{value:"\u5e38\u7528\u7684\u63d2\u4ef6",id:"\u5e38\u7528\u7684\u63d2\u4ef6",children:[],level:3}],level:2},{value:"gulp",id:"gulp",children:[{value:"gulp\u7684\u7ec4\u5408\u4efb\u52a1",id:"gulp\u7684\u7ec4\u5408\u4efb\u52a1",children:[],level:3},{value:"gulp\u7684\u7ec4\u5408\u4efb\u52a1",id:"gulp\u7684\u7ec4\u5408\u4efb\u52a1-1",children:[],level:3},{value:"Gulp\u7684\u5f02\u6b65\u4efb\u52a1",id:"gulp\u7684\u5f02\u6b65\u4efb\u52a1",children:[],level:3},{value:"Gulp\u6784\u5efa\u8fc7\u7a0b\u6838\u5fc3\u5de5\u4f5c\u539f\u7406",id:"gulp\u6784\u5efa\u8fc7\u7a0b\u6838\u5fc3\u5de5\u4f5c\u539f\u7406",children:[],level:3},{value:"Gulp\u6587\u4ef6\u64cd\u4f5cAPI",id:"gulp\u6587\u4ef6\u64cd\u4f5capi",children:[],level:3},{value:"Gulp\u6848\u4f8b",id:"gulp\u6848\u4f8b",children:[{value:"\u6837\u5f0f\u7f16\u8bd1",id:"\u6837\u5f0f\u7f16\u8bd1",children:[],level:4},{value:"\u811a\u672c\u7f16\u8bd1",id:"\u811a\u672c\u7f16\u8bd1",children:[],level:4},{value:"\u6a21\u677f\u7f16\u8bd1",id:"\u6a21\u677f\u7f16\u8bd1",children:[],level:4},{value:"\u56fe\u7247\u548c\u5b57\u4f53\u6587\u4ef6\u8f6c\u6362",id:"\u56fe\u7247\u548c\u5b57\u4f53\u6587\u4ef6\u8f6c\u6362",children:[],level:4},{value:"\u5176\u4ed6\u6587\u4ef6\u53ca\u6587\u4ef6\u6e05\u9664",id:"\u5176\u4ed6\u6587\u4ef6\u53ca\u6587\u4ef6\u6e05\u9664",children:[],level:4},{value:"\u81ea\u52a8\u52a0\u8f7d\u63d2\u4ef6",id:"\u81ea\u52a8\u52a0\u8f7d\u63d2\u4ef6",children:[],level:4},{value:"\u5f00\u53d1\u670d\u52a1\u5668",id:"\u5f00\u53d1\u670d\u52a1\u5668",children:[],level:4},{value:"\u76d1\u89c6\u53d8\u5316\u53ca\u6784\u5efa\u4f18\u5316",id:"\u76d1\u89c6\u53d8\u5316\u53ca\u6784\u5efa\u4f18\u5316",children:[],level:4},{value:"useref\u6587\u4ef6\u5904\u7406\u5f15\u7528",id:"useref\u6587\u4ef6\u5904\u7406\u5f15\u7528",children:[],level:4},{value:"\u6587\u4ef6\u538b\u7f29",id:"\u6587\u4ef6\u538b\u7f29",children:[],level:4},{value:"\u91cd\u65b0\u89c4\u5212\u6784\u5efa\u8fc7\u7a0b",id:"\u91cd\u65b0\u89c4\u5212\u6784\u5efa\u8fc7\u7a0b",children:[],level:4}],level:3},{value:"\u5c01\u88c5\u5de5\u4f5c\u6d41",id:"\u5c01\u88c5\u5de5\u4f5c\u6d41",children:[{value:"\u63d0\u53d6gulpfile",id:"\u63d0\u53d6gulpfile",children:[],level:4},{value:"\u89e3\u51b3\u6a21\u5757\u4e2d\u7684\u95ee\u9898",id:"\u89e3\u51b3\u6a21\u5757\u4e2d\u7684\u95ee\u9898",children:[],level:4},{value:"\u62bd\u8c61\u8def\u5f84\u914d\u7f6e",id:"\u62bd\u8c61\u8def\u5f84\u914d\u7f6e",children:[],level:4}],level:3}],level:2},{value:"FIS",id:"fis",children:[],level:2},{value:"gulp\u81ea\u52a8\u5316\u6784\u5efa\u793a\u4f8b\u4ee3\u7801",id:"gulp\u81ea\u52a8\u5316\u6784\u5efa\u793a\u4f8b\u4ee3\u7801",children:[],level:2}],u={toc:o};function d(n){var e=n.components,s=(0,l.Z)(n,a);return(0,r.kt)("wrapper",(0,t.Z)({},u,s,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u81ea\u52a8\u5316\u6784\u5efa"},"\u81ea\u52a8\u5316\u6784\u5efa"),(0,r.kt)("p",null,"\u4e00\u5207\u91cd\u590d\u5de5\u4f5c\u672c\u5e94\u81ea\u52a8\u5316\n\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u4f5c\u6d41\n\u8131\u79bb\u8fd0\u884c\u73af\u5883\u517c\u5bb9\u5e26\u6765\u7684\u95ee\u9898\n\u4f7f\u7528\u63d0\u9ad8\u6548\u7387\u7684\u8bed\u6cd5\u3001\u89c4\u8303\u548c\u6807\u51c6\n\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u5177\u6784\u5efa\u8f6c\u6362\u90a3\u4e9b\u4e0d\u88ab\u652f\u6301\u7684\u7279\u6027"),(0,r.kt)("h2",{id:"\u81ea\u52a8\u5316\u6784\u5efa\u521d\u4f53\u9a8c"},"\u81ea\u52a8\u5316\u6784\u5efa\u521d\u4f53\u9a8c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install sass --save-dev\n")),(0,r.kt)("p",null,"\u521b\u5efa\u4e00\u4e2ascss\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scss"},"$color:red;\n\nbody {\n    color: $color;\n}\n")),(0,r.kt)("p",null,"\u5728package.json\u6dfb\u52a0script"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'  "scripts": {\n    "build-sass": "sass code/scss/style.scss code/css/style.css"\n  }\n')),(0,r.kt)("p",null,"\u6267\u884c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm run build-sass\n")),(0,r.kt)("p",null,"\u5b89\u88c5browser-sync"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install browser-sync --save-dev\n")),(0,r.kt)("p",null,"\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u521b\u5efa",(0,r.kt)("inlineCode",{parentName:"p"},"index.html"),"\n\u5728package.json\u6dfb\u52a0script"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'  "scripts": {\n    "build-sass": "sass code/scss/style.scss code/css/style.css",\n    "serve": "browser-sync ."\n  }\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm run serve\n")),(0,r.kt)("p",null,"\u5b89\u88c5npm-run-all"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install npm-run-all --save-dev\n")),(0,r.kt)("p",null,"\u6267\u884c\u5b8cbuild-sass\u6267\u884c\u5b8c\u540e\u518d\u6267\u884cserve"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},' "scripts": {\n    "build-sass": "sass code/scss/style.scss code/css/style.css --watch",\n    "serve": "browser-sync . --files \\"./code/css/*.css\\"",\n    "start":"run-p build-sass serve"\n  }\n')),(0,r.kt)("p",null,"\u5176\u4e2d",(0,r.kt)("inlineCode",{parentName:"p"},'--files \\"./code/css/*.css\\"'),"\u662f\u76d1\u542ccss\u6587\u4ef6\u53d8\u5316"),(0,r.kt)("h2",{id:"\u5e38\u7528\u7684\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u5177"},"\u5e38\u7528\u7684\u81ea\u52a8\u5316\u6784\u5efa\u5de5\u5177"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Grunt",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u63d2\u4ef6\u751f\u6001\u6bd4\u8f83\u5b8c\u5584"),(0,r.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8fc7\u7a0b\u57fa\u4e8e\u4e34\u65f6\u6587\u4ef6\uff0c\u6240\u4ee5\u6784\u5efa\u901f\u5ea6\u76f8\u5bf9\u8f83\u6162"))),(0,r.kt)("li",{parentName:"ul"},"Gulp",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u5904\u7406\u73af\u8282\u90fd\u662f\u5728\u5185\u5b58\u4e2d\u5b9e\u73b0\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u652f\u6301\u540c\u65f6\u6267\u884c\u591a\u4e2a\u4efb\u52a1"))),(0,r.kt)("li",{parentName:"ul"},"FIS",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u9879\u76ee\u4e2d\u5178\u578b\u7684\u9700\u6c42\u5c3d\u53ef\u80fd\u90fd\u96c6\u6210\u5728\u5185\u90e8")))),(0,r.kt)("h2",{id:"grunt"},"Grunt"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install grunt --save-dev\n")),(0,r.kt)("p",null,"\u6ce8\u518c\u4efb\u52a1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * Grunt\u7684\u5165\u53e3\u6587\u4ef6\n * \u7528\u4e8e\u5b9a\u4e49\u4e00\u4e9b\u9700\u8981Grunt\u81ea\u52a8\u6267\u884c\u7684\u4efb\u52a1\n * \u9700\u8981\u5bfc\u51fa\u4e00\u4e2a\u51fd\u6570\n * \u6b64\u51fd\u6570\u63a5\u6536\u4e00\u4e2aGrunt\u5f62\u53c2\uff0c\u5185\u90e8\u63d0\u4f9b\u4e00\u4e9b\u521b\u5efa\u4efb\u52a1\u662f\u53ef\u4ee5\u7528\u5230\u7684API\n */\nmodule.exports = grunt => {\n    // \u6ce8\u518c\u4efb\u52a1\n    grunt.registerTask('foo', () => {\n        console.log('hello grunt')\n    })\n    grunt.registerTask('bar', '\u4efb\u52a1\u63cf\u8ff0', () => {\n        console.log('hello grunt')\n    })\n\n    // \u6ce8\u518c\u5f02\u6b65\u4efb\u52a1\n    // grunt\u9ed8\u8ba4\u652f\u6301\u540c\u6b65\u6a21\u5f0f\uff0c\u82e5\u8981\u652f\u6301\u5f02\u6b65\u6a21\u5f0f\uff0c\n    // \u5fc5\u987b\u4f7f\u7528this.async()\u5f97\u5230\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u5f02\u6b65\u64cd\u4f5c\u5b8c\u6210\u540e\u8c03\u7528\u8bf8\u845b\u5f02\u6b65\u51fd\u6570\n    grunt.registerTask('async-task', function () {\n        const done = this.async()\n        setTimeout(() => {\n            console.log('async-task')\n            done()\n        }, 1000)\n    })\n\n    // \u9ed8\u8ba4\u4efb\u52a1\n    // grunt.registerTask('default', () => {\n    //     console.log('default')\n    // })\n\n    grunt.registerTask('default', ['foo',  'async-task', 'bar'])\n}\n")),(0,r.kt)("h3",{id:"\u6807\u8bb0\u5931\u8d25\u4efb\u52a1"},"\u6807\u8bb0\u5931\u8d25\u4efb\u52a1"),(0,r.kt)("p",null,"\u53ef\u4ee5\u5728\u4efb\u52a1\u51fd\u6570\u4f53\u8fd4\u56defalse"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"   grunt.registerTask('bad', () => {\n        console.log('bad')\n        return false\n    })\n")),(0,r.kt)("p",null,"\u591a\u4e2a\u4efb\u52a1\u51fa\u9519\u540e\u5176\u4ed6\u4efb\u52a1\u7ee7\u7eed\u6267\u884c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm grunt --force\n")),(0,r.kt)("p",null,"\u5f02\u6b65\u4efb\u52a1\u6807\u8bb0\u5931\u8d25"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"   // \u6807\u8bb0\u5f02\u6b65\u5931\u8d25\u4efb\u52a1\n    grunt.registerTask('bad-async-task', function () {\n        const done = this.async()\n        setTimeout(() => {\n            console.log('bad-async-task')\n            done(false)\n        }, 1000)\n    })\n")),(0,r.kt)("h3",{id:"grunt\u7684\u914d\u7f6e\u65b9\u6cd5"},"Grunt\u7684\u914d\u7f6e\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = grunt => {\n    // \u914d\u7f6e\n    grunt.initConfig({\n        foo: {\n            name: 'foo'\n        }\n    })\n    grunt.registerTask('foo', () => {\n        console.log(grunt.config('foo'))//{ name: 'foo' }\n    })\n    grunt.registerTask('default', ['foo'])\n}\n")),(0,r.kt)("h3",{id:"\u591a\u76ee\u6807\u4efb\u52a1"},"\u591a\u76ee\u6807\u4efb\u52a1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = grunt => {\n    grunt.initConfig({\n        build:{\n            // \u4f1a\u4f5c\u4e3a\u4efb\u52a1\u7684\u914d\u7f6e(\u4e0d\u4f1a\u4f5c\u4e3atask )  \n            options:{\n                foo:'aaa'\n            },\n            css:{\n                name:'css',\n                // \u4f1a\u5408\u5e76\u4efb\u52a1\u914d\u7f6e\u4e2d\u7684options\uff0c\u5982\u679c\u5b58\u5728\u76f8\u540c\u5c5e\u6027\uff0c\u4f1a\u8986\u76d6\n                options:{\n                    foo:'css'\n                }\n            },\n            js:'js'\n        }\n    })\n    // \u591a\u76ee\u6807\u6a21\u5f0f\n    grunt.registerMultiTask('build',function() {\n        console.log('build')\n        console.log('target:',this.target)\n        console.log('data:',this.data)\n        console.log('options:',this.options())\n    })\n}\n")),(0,r.kt)("h3",{id:"grunt\u63d2\u4ef6\u7684\u4f7f\u7528"},"Grunt\u63d2\u4ef6\u7684\u4f7f\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install grunt-contrib-clean --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = grunt => {\n    grunt.initConfig({\n        clean: {\n            temp: 'code/**/*.css'\n        }\n    })\n    grunt.loadNpmTasks('grunt-contrib-clean')\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm grunt clean\n")),(0,r.kt)("h3",{id:"\u5e38\u7528\u7684\u63d2\u4ef6"},"\u5e38\u7528\u7684\u63d2\u4ef6"),(0,r.kt)("p",null,"grunt-sass"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install grunt-sass sass --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const sass = require('sass')\n\nmodule.exports = grunt => {\n    grunt.initConfig({\n        sass: {\n            options: {\n                sourceMap:true,\n                implementation: sass\n            },\n            main: {\n                files: {\n                    'dist/css/main.css': 'dist/scss/main.scss'\n                }\n            }\n        }\n    })\n    grunt.loadNpmTasks('grunt-sass')\n}\n")),(0,r.kt)("p",null,"\u7f16\u8bd1es6",(0,r.kt)("br",{parentName:"p"}),"\n","\u5b89\u88c5babel\u548cload-grunt-tasks"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"}," npm install grunt-babel @babel/core @babel/preset-env load-grunt-tasks --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const sass = require('sass')\nconst loadGruntTasks = require('load-grunt-tasks')\n\nmodule.exports = grunt => {\n    grunt.initConfig({\n        sass: {\n            options: {\n                sourceMap: true,\n                implementation: sass\n            },\n            main: {\n                files: {\n                    'dist/css/main.css': 'src/scss/main.scss'\n                }\n            }\n        },\n        babel: {\n            options: {\n                sourceMap: true,\n                presets: ['@babel/preset-env']\n            },\n            main: {\n                files: {\n                    'dist/js/app.js': 'src/js/app.js'\n                }\n            }\n        },\n        watch: {\n            js: {\n                files: ['src/**/*.js'],\n                tasks: ['babel']\n            },\n            css: {\n                files: ['src/**/*.scss'],\n                tasks: ['sass']\n            }\n        }\n    })\n    // \u81ea\u52a8\u52a0\u8f7d\u6240\u6709\u7684grunt\u63d2\u4ef6\u4e2d\u7684\u4efb\u52a1\n    loadGruntTasks(grunt)\n    grunt.registerTask('default', ['sass', 'babel', 'watch'])\n}\n")),(0,r.kt)("h2",{id:"gulp"},"gulp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install gulp --save-dev\n")),(0,r.kt)("p",null,"\u521b\u5efa\u4e00\u4e2agulpfile.js\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n    foo(done) {\n        console.log('qwe')\n        done() //\u6807\u8bc6\u4efb\u52a1\u7ed3\u675f\n    },\n    // \u9ed8\u8ba4\u4efb\u52a1\n    default (done) {\n        console.log('default')\n        done()\n    }\n}\n\n// gulp 4.0\u4e4b\u524d\u7684\u7528\u6cd5\uff0c\u4e0d\u63a8\u8350\u4f7f\u7528\nconst gulp = require('gulp')\ngulp.task('bar', done => {\n    console.log('bar working')\n    done()\n})\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm gulp foo\n")),(0,r.kt)("h3",{id:"gulp\u7684\u7ec4\u5408\u4efb\u52a1"},"gulp\u7684\u7ec4\u5408\u4efb\u52a1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    series,\n    parallel\n} = require('gulp')\n\nconst task1 = done => {\n    setTimeout(() => {\n        console.log('task1 done')\n        done()\n    }, 1000)\n}\nconst task2 = done => {\n    setTimeout(() => {\n        console.log('task2 done')\n        done()\n    }, 1000)\n}\nconst task3 = done => {\n    setTimeout(() => {\n        console.log('task3 done')\n        done()\n    }, 1000)\n}\n\nmodule.exports = {\n    foo: series(task1, task2, task3), //\u4e32\u884c\u591a\u4e2a\u4efb\u52a1\n    bar: parallel(task1, task2, task3) //\u5e76\u591a\u4e2a\u884c\u4efb\u52a1\n}\n")),(0,r.kt)("h3",{id:"gulp\u7684\u7ec4\u5408\u4efb\u52a1-1"},"gulp\u7684\u7ec4\u5408\u4efb\u52a1"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u9700\u8981\u8ba9\u4efb\u52a1\uff08task\uff09\u6309\u987a\u5e8f\u6267\u884c\uff0c\u8bf7\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"series()")," \u65b9\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u5e0c\u671b\u4ee5\u6700\u5927\u5e76\u53d1\u6765\u8fd0\u884c\u7684\u4efb\u52a1\uff08tasks\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"parallel()")," \u65b9\u6cd5\u5c06\u5b83\u4eec\u7ec4\u5408\u8d77\u6765\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    series,\n    parallel\n} = require('gulp')\n\nconst task1 = done => {\n    setTimeout(() => {\n        console.log('task1 done')\n        done()\n    }, 1000)\n}\nconst task2 = done => {\n    setTimeout(() => {\n        console.log('task2 done')\n        done()\n    }, 1000)\n}\nconst task3 = done => {\n    setTimeout(() => {\n        console.log('task3 done')\n        done()\n    }, 1000)\n}\n\nmodule.exports = {\n    foo: series(task1, task2, task3), //\u4e32\u884c\u591a\u4e2a\u4efb\u52a1\n    bar: parallel(task1, task2, task3) //\u5e76\u591a\u4e2a\u884c\u4efb\u52a1\n}\n")),(0,r.kt)("h3",{id:"gulp\u7684\u5f02\u6b65\u4efb\u52a1"},"Gulp\u7684\u5f02\u6b65\u4efb\u52a1"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.gulpjs.com.cn/docs/getting-started/async-completion/"},"https://www.gulpjs.com.cn/docs/getting-started/async-completion/")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\n\nmodule.exports = {\n    callback(done) {\n        console.log('callback')\n        done()\n    },\n    callback_error(done) {\n        console.log('callback_error')\n        done(new Error('task error'))\n    },\n    promise() {\n        console.log('promise')\n        return Promise.reject('promise error')\n    },\n    async async () {\n        await timeout(2000)\n        console.log('async task')\n    },\n    stream(done) {\n        const readStream = fs.createReadStream('./package.json')\n        const writeStream = fs.createWriteStream('package.txt')\n        readStream.pipe(writeStream)\n        // readStream.on('end',()=>{\n        //     console.log('end')\n        //     done()\n        // })\n        return readStream\n    }\n}\nconst timeout = time => new Promise(resolve => setTimeout(resolve, time))\n")),(0,r.kt)("h3",{id:"gulp\u6784\u5efa\u8fc7\u7a0b\u6838\u5fc3\u5de5\u4f5c\u539f\u7406"},"Gulp\u6784\u5efa\u8fc7\u7a0b\u6838\u5fc3\u5de5\u4f5c\u539f\u7406"),(0,r.kt)("p",null,"\u6a21\u62df\u5b9e\u73b0\u7b80\u5355\u7684css\u538b\u7f29\u529f\u80fd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    createReadStream,\n    createWriteStream\n} = require('fs')\nconst {\n    Transform\n} = require('stream')\n\nmodule.exports = {\n    default () {\n        const read = createReadStream('././src/css/style.css')\n        const write = createWriteStream('./src/css/style.min.css')\n        // \u8f6c\u6362\n        const transform = new Transform({\n            transform(chunk, encoding, callback) {\n                // \u6838\u5fc3\u8f6c\u6362\u8fc7\u7a0b\n                // chunk=> \u8bfb\u53d6\u6d41\u4e2d\u8bfb\u53d6\u5230\u7684\u5185\u5bb9\uff08Buffer\uff09\n                const input = chunk.toString()\n                const output = input.replace(/\\s+/g, '').replace(/\\/\\*.+?\\*\\//g, '')\n                callback(null, output)\n            }\n        })\n        read\n            .pipe(transform) //\u8f6c\u6362\n            .pipe(write) //\u5199\u5165\n        return read\n    }\n}\n")),(0,r.kt)("h3",{id:"gulp\u6587\u4ef6\u64cd\u4f5capi"},"Gulp\u6587\u4ef6\u64cd\u4f5cAPI"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src()")," \u63a5\u53d7 glob \u53c2\u6570\uff0c\u5e76\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u6587\u4ef6\u7136\u540e\u751f\u6210\u4e00\u4e2a Node \u6d41\uff08stream\uff09\u3002\u5b83\u5c06\u6240\u6709\u5339\u914d\u7684\u6587\u4ef6\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d\u5e76\u901a\u8fc7\u6d41\uff08stream\uff09\u8fdb\u884c\u5904\u7406\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dest()")," \u53ef\u4ee5\u7528\u5728\u7ba1\u9053\uff08pipeline\uff09\u4e2d\u95f4\u7528\u4e8e\u5c06\u6587\u4ef6\u7684\u4e2d\u95f4\u72b6\u6001\u5199\u5165\u6587\u4ef6\u7cfb\u7edf")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest\n} = require('gulp')\nconst cleanCss = require('gulp-clean-css')\nconst rename = require('gulp-rename')\n\nmodule.exports = {\n    default () {\n        return src('src/css/*.css')\n            .pipe(cleanCss())\n            .pipe(rename({\n                extname: '.min.css'\n            }))\n            .pipe(dest('dist/css'))\n    }\n}\n")),(0,r.kt)("h3",{id:"gulp\u6848\u4f8b"},"Gulp\u6848\u4f8b"),(0,r.kt)("h4",{id:"\u6837\u5f0f\u7f16\u8bd1"},"\u6837\u5f0f\u7f16\u8bd1"),(0,r.kt)("p",null,"\u5b89\u88c5",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dlmanning/gulp-sass"},"gulp-sass")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install gulp-sass --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest\n} = require('gulp')\nconst sass = require('gulp-sass')\n\nconst style = () => {\n    return src('src/css/*.scss', {\n            base: 'src'\n        })\n        .pipe(sass({\n            outputStyle: 'expanded' //\u5b8c\u5168\u5c55\u5f00css\n        }))\n        .pipe(dest('dist'))\n}\nmodule.exports = {\n    style\n}\n")),(0,r.kt)("h4",{id:"\u811a\u672c\u7f16\u8bd1"},"\u811a\u672c\u7f16\u8bd1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const script = () => {\n    return src('src/js/*.js', {\n            base: 'src'\n        })\n        .pipe(babel({\n            presets: ['@babel/preset-env']\n        }))\n        .pipe(dest('dist'))\n}\n")),(0,r.kt)("h4",{id:"\u6a21\u677f\u7f16\u8bd1"},"\u6a21\u677f\u7f16\u8bd1"),(0,r.kt)("p",null,"\u4f7f\u7528ejs\u6a21\u677f\u5f15\u64ce\u7f16\u8bd1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install gulp-ejs --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest\n} = require('gulp')\nconst ejs = require('gulp-ejs')\n\nconst page = () => {\n    return src('src/*.html', {\n            base: 'src'\n        })\n        .pipe(ejs({\n            title: 'gulp\u9875\u9762\u6a21\u677f\u7f16\u8bd1'\n        }))\n        .pipe(dest('dist'))\n}\n")),(0,r.kt)("h4",{id:"\u56fe\u7247\u548c\u5b57\u4f53\u6587\u4ef6\u8f6c\u6362"},"\u56fe\u7247\u548c\u5b57\u4f53\u6587\u4ef6\u8f6c\u6362"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install imagemin --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest\n} = require('gulp')\nconst imagemin = require('gulp-imagemin')\nconst assets = () => {\n    return src('src/assets/**', {\n            base: 'src'\n        })\n        .pipe(imagemin())\n        .pipe(dest('dist'))\n}\n")),(0,r.kt)("h4",{id:"\u5176\u4ed6\u6587\u4ef6\u53ca\u6587\u4ef6\u6e05\u9664"},"\u5176\u4ed6\u6587\u4ef6\u53ca\u6587\u4ef6\u6e05\u9664"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install del --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const clean = () => {\n    return del(['dist'])\n}\n")),(0,r.kt)("h4",{id:"\u81ea\u52a8\u52a0\u8f7d\u63d2\u4ef6"},"\u81ea\u52a8\u52a0\u8f7d\u63d2\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install gulp-load-plugins --save-dev\n")),(0,r.kt)("p",null,"\u5c06\u4e4b\u524drequire\u7684gulp\u63d2\u4ef6\u66ff\u6362\u4e3aplugins.**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest,\n    parallel,\n    series\n} = require('gulp')\nconst loadPlugins = require('gulp-load-plugins')\nconst plugins = loadPlugins()\nconst del = require('del')\n\nconst style = () => {\n    return src('src/css/*.scss', {\n            base: 'src'\n        })\n        .pipe(plugins.sass({\n            outputStyle: 'expanded' //\u5b8c\u5168\u5c55\u5f00css\n        }))\n        .pipe(dest('dist'))\n}\n\nconst script = () => {\n    return src('src/js/*.js', {\n            base: 'src'\n        })\n        .pipe(plugins.babel({\n            presets: ['@babel/preset-env']\n        }))\n        .pipe(dest('dist'))\n}\n\nconst page = () => {\n    return src('src/*.html', {\n            base: 'src'\n        })\n        .pipe(plugins.ejs({\n            title: 'gulp\u9875\u9762\u6a21\u677f\u7f16\u8bd1',\n        }, {\n            rmWhitespace: false\n        }))\n        .pipe(dest('dist'))\n}\nconst assets = () => {\n    return src('src/assets/**', {\n            base: 'src'\n        })\n        .pipe(imagemin())\n        .pipe(dest('dist'))\n}\nconst extra = () => {\n    return src('src/public/**/*', {\n            base: 'src'\n        })\n        .pipe(dest('dist'))\n}\nconst clean = () => {\n    return del(['dist'])\n}\n\nconst compile = parallel(style, script, page, assets)\nconst build = series(clean, parallel(compile, extra))\n\nmodule.exports = {\n    build\n}\n")),(0,r.kt)("h4",{id:"\u5f00\u53d1\u670d\u52a1\u5668"},"\u5f00\u53d1\u670d\u52a1\u5668"),(0,r.kt)("p",null,"\u70ed\u66f4\u65b0\u5f00\u53d1\u670d\u52a1\u5668"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install borwser-sync --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const borwserSync = require('browser-sync')\nconst bs = borwserSync.create()\n\nconst serve = () => {\n    return bs.init({\n        notify: false,\n        open: false,//\u662f\u5426\u6253\u5f00\u6d4f\u89c8\u5668\n        // port  \u6253\u5f00\u7aef\u53e3\u53f7\n        files:'dist/**',//\u4fee\u6539\u6587\u4ef6\u540e \u81ea\u52a8\u5237\u65b0\n        server: {\n            baseDir: 'dist',\n            routes:{\n                '/node_modules':'node_modules'\n            }\n        }\n    })\n}\n")),(0,r.kt)("h4",{id:"\u76d1\u89c6\u53d8\u5316\u53ca\u6784\u5efa\u4f18\u5316"},"\u76d1\u89c6\u53d8\u5316\u53ca\u6784\u5efa\u4f18\u5316"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.gulpjs.com.cn/docs/api/watch/"},"gulp.watch()"),"  \u76d1\u542c globs \u5e76\u5728\u53d1\u751f\u66f4\u6539\u65f6\u8fd0\u884c\u4efb\u52a1\u3002\u4efb\u52a1\u4e0e\u4efb\u52a1\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u88ab\u7edf\u4e00\u5904\u7406\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest,\n    parallel,\n    series,\n    watch\n} = require('gulp')\nconst style = () => {\n    return src('src/css/*.scss', {\n            base: 'src'\n        })\n        .pipe(plugins.sass({\n            outputStyle: 'expanded' //\u5b8c\u5168\u5c55\u5f00css\n        }))\n        .pipe(dest('dist'))\n        // .pipe(bs.reload({stream:true}))  bs.init  files\u53ef\u4ee5\u4e0d\u5199\n}\n\nconst serve = () => {\n    watch('src/css/*.scss', style)\n    watch('src/js/*.js', script)\n    watch('src/*.html', page)\n\n    // \u51cf\u5c11\u6784\u5efa\u6b21\u6570\n    watch([\n        'src/assets/**',\n        'src/public/**/*'\n    ], bs.reload)\n\n  ...\n}\n\nconst compile = parallel(style, script, page)//assets, extra\u5f00\u53d1\u9636\u6bb5\u4e0d\u7f16\u8bd1\nconst build = series(clean, parallel(compile, assets, extra))\nconst dev = series(compile, serve)\n")),(0,r.kt)("h4",{id:"useref\u6587\u4ef6\u5904\u7406\u5f15\u7528"},"useref\u6587\u4ef6\u5904\u7406\u5f15\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const useref = () => {\n    return src('dist/*.html', {\n            base: 'dist'\n        })\n        .pipe(plugins.useref({\n            searchPath: ['dist', '.']\n        }))\n        .pipe(dest('dist'))\n}\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/jonkemp/gulp-useref"},"useref")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n<head>\n    \x3c!-- build:css css/combined.css --\x3e\n    <link href="css/one.css" rel="stylesheet">\n    <link href="css/two.css" rel="stylesheet">\n    \x3c!-- endbuild --\x3e\n</head>\n<body>\n    \x3c!-- build:js scripts/combined.js --\x3e\n    <script type="text/javascript" src="scripts/one.js"><\/script>\n    <script type="text/javascript" src="scripts/two.js"><\/script>\n    \x3c!-- endbuild --\x3e\n</body>\n</html>\n')),(0,r.kt)("p",null,"useref\u5904\u7406\u540e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n<head>\n    <link rel="stylesheet" href="css/combined.css"/>\n</head>\n<body>\n    <script src="scripts/combined.js"><\/script>\n</body>\n</html>\n')),(0,r.kt)("h4",{id:"\u6587\u4ef6\u538b\u7f29"},"\u6587\u4ef6\u538b\u7f29"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install gulp-if gulp-clean-css gulp-uglify gulp-htmlmin --save-dev\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const useref = () => {\n    return src('dist/*.html', {\n            base: 'dist'\n        })\n        .pipe(plugins.useref({\n            searchPath: ['dist', '.']\n        }))\n        .pipe(plugins.if(/\\.js$/,plugins.uglify()))\n        .pipe(plugins.if(/\\.css$/,plugins.cleanCss()))\n        .pipe(plugins.if(/\\.html$/,plugins.htmlmin({\n            collapseWhitespace:true,\n            mimifyJS:true,\n            minifyCSS:true\n        })))\n        .pipe(dest('release'))\n}\n")),(0,r.kt)("h4",{id:"\u91cd\u65b0\u89c4\u5212\u6784\u5efa\u8fc7\u7a0b"},"\u91cd\u65b0\u89c4\u5212\u6784\u5efa\u8fc7\u7a0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n    src,\n    dest,\n    parallel,\n    series,\n    watch\n} = require('gulp')\nconst loadPlugins = require('gulp-load-plugins')\nconst plugins = loadPlugins()\nconst del = require('del')\nconst borwserSync = require('browser-sync')\nconst bs = borwserSync.create()\n\nconst style = () => {\n    return src('src/css/*.scss', {\n            base: 'src'\n        })\n        .pipe(plugins.sass({\n            outputStyle: 'expanded' //\u5b8c\u5168\u5c55\u5f00css\n        }))\n        .pipe(dest('temp'))\n}\n\nconst script = () => {\n    return src('src/js/*.js', {\n            base: 'src'\n        })\n        .pipe(plugins.babel({\n            presets: ['@babel/preset-env']\n        }))\n        .pipe(dest('temp'))\n}\n\nconst page = () => {\n    return src('src/*.html', {\n            base: 'src'\n        })\n        .pipe(plugins.ejs({\n            title: 'gulp\u9875\u9762\u6a21\u677f\u7f16\u8bd1',\n        }, {\n            rmWhitespace: false\n        }))\n        .pipe(dest('temp'))\n}\nconst assets = () => {\n    return src('src/assets/**', {\n            base: 'src'\n        })\n        // .pipe(imagemin())\n        .pipe(dest('dist'))\n}\nconst extra = () => {\n    return src('src/public/**/*', {\n            base: 'src'\n        })\n        .pipe(dest('dist'))\n}\nconst useref = () => {\n    return src('temp/*.html', {\n            base: 'temp'\n        })\n        .pipe(plugins.useref({\n            searchPath: ['temp', '.']\n        }))\n        .pipe(plugins.if(/\\.js$/, plugins.uglify()))\n        .pipe(plugins.if(/\\.css$/, plugins.cleanCss()))\n        .pipe(plugins.if(/\\.html$/, plugins.htmlmin({\n            collapseWhitespace: true,\n            mimifyJS: true,\n            minifyCSS: true\n        })))\n        .pipe(dest('dist'))\n}\n\n\n\nconst clean = () => {\n    return del(['dist','temp'])\n}\nconst serve = () => {\n    watch('src/css/*.scss', style)\n    watch('src/js/*.js', script)\n    watch('src/*.html', page)\n\n    watch([\n        'src/assets/**',\n        'src/public/**/*'\n    ], bs.reload)\n\n    bs.init({\n        notify: false,\n        open: false, //\u662f\u5426\u6253\u5f00\u6d4f\u89c8\u5668\n        files: 'dist/**', //\u4fee\u6539\u6587\u4ef6\u540e \u81ea\u52a8\u5237\u65b0\n        server: {\n            baseDir: ['temp', 'src'],\n            routes: {\n                '/node_modules': 'node_modules'\n            }\n        }\n    })\n}\nconst compile = parallel(style, script, page)\nconst build = series(\n    clean,\n    parallel(\n        (series(compile, useref)),\n        assets,\n        extra\n    ))\nconst dev = series(compile, serve)\nmodule.exports = {\n    clean,\n    build,\n    dev\n}\n")),(0,r.kt)("h3",{id:"\u5c01\u88c5\u5de5\u4f5c\u6d41"},"\u5c01\u88c5\u5de5\u4f5c\u6d41"),(0,r.kt)("h4",{id:"\u63d0\u53d6gulpfile"},"\u63d0\u53d6gulpfile"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u65b0\u5efa\u4e00\u4e2a\u9879\u76eeA,\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"npm init")),(0,r.kt)("li",{parentName:"ul"},"\u5c06\u4e4b\u524d\u5b89\u88c5\u7684gulp\u76f8\u5173\u4f9d\u8d56\u5b89\u88c5\u5230\u9879\u76ee\u4e0b"),(0,r.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u5165\u53e3\u6587\u4ef6\uff0c\u5e76\u5c06\u4e4b\u524d\u5199\u7684gulpfile.js\u6587\u4ef6\u653e\u5230\u5165\u53e3\u6587\u4ef6\u4e2d"),(0,r.kt)("li",{parentName:"ul"},"\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"yarn link"),"\u6216",(0,r.kt)("inlineCode",{parentName:"li"},"npm link")),(0,r.kt)("li",{parentName:"ul"},"\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"yarn link \u9879\u76eeA\u540d\u79f0"),"\u6216",(0,r.kt)("inlineCode",{parentName:"li"},"npm link \u9879\u76eeA\u540d\u79f0")),(0,r.kt)("li",{parentName:"ul"},"\u4fee\u6539\u539f\u6765\u7684\u9879\u76ee\u4e0bgulpfile.js\u6587\u4ef6")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = require('\u9879\u76eeA\u540d\u79f0')\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"yarn gulp build"),"\u6216",(0,r.kt)("inlineCode",{parentName:"li"},"npm gulp build"))),(0,r.kt)("h4",{id:"\u89e3\u51b3\u6a21\u5757\u4e2d\u7684\u95ee\u9898"},"\u89e3\u51b3\u6a21\u5757\u4e2d\u7684\u95ee\u9898"),(0,r.kt)("p",null,"\u63d0\u53d6\u4e0d\u5e94\u516c\u5171\u4f7f\u7528\u7684\u90e8\u5206\u6a21\u5757  "),(0,r.kt)("p",null,"\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2ajs\u6587\u4ef6\uff0c\u5c06\u4e0d\u5728\u516c\u5171\u6a21\u5757\u7684\u5185\u5bb9\u63d0\u53d6\u5230\u8be5\u6587\u4ef6  "),(0,r.kt)("p",null,"\u9879\u76ee\u914d\u7f6e\u6587\u4ef6pages.config.js"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n    title: 'gulp\u6784\u5efa'\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let config = {\n  title: ''\n}\ntry {\n  loadConfig = require(`${cwd}/pages.config.js`)\n  config = Object.assign({}, config, loadConfig)\n} catch (e) {\n\n}\n")),(0,r.kt)("h4",{id:"\u62bd\u8c61\u8def\u5f84\u914d\u7f6e"},"\u62bd\u8c61\u8def\u5f84\u914d\u7f6e"),(0,r.kt)("h2",{id:"fis"},"FIS"),(0,r.kt)("p",null,"\u5b89\u88c5",(0,r.kt)("a",{parentName:"p",href:"http://fis.baidu.com/fis3/index.html"},"fis3"),"\u5230\u9879\u76ee\u76ee\u5f55\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install fis3 --save-dev\n")),(0,r.kt)("p",null,"\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2afis\u7684\u914d\u7f6e\u6587\u4ef6",(0,r.kt)("inlineCode",{parentName:"p"},"fis-conf.js")),(0,r.kt)("p",null," FIS3 \u914d\u7f6e\u6587\u4ef6\uff08\u9ed8\u8ba4fis-conf.js\uff09\u6240\u5728\u7684\u76ee\u5f55\u4e3a\u9879\u76ee\u6839\u76ee\u5f55\n",(0,r.kt)("inlineCode",{parentName:"p"},"fis3 release -d <path>"),"\u5c06\u8d44\u6e90\u53d1\u5e03\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"<path>"),"  "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fis.match(selector, props)"),"   "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"selector\uff1a FIS3 \u628a\u5339\u914d\u6587\u4ef6\u8def\u5f84\u7684\u8def\u5f84\u4f5c\u4e3aselector\uff0c\u5339\u914d\u5230\u7684\u6587\u4ef6\u4f1a\u5206\u914d\u7ed9\u5b83\u8bbe\u7f6e\u7684 props"),(0,r.kt)("li",{parentName:"ul"},"props \uff1a\u7f16\u8bd1\u89c4\u5219\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u5c5e\u6027\u548c\u63d2\u4ef6\u5c5e\u6027")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u5904\u7406\u6587\u4ef6\u8def\u5f84\nfis.match('*.{js,scss,png}',{\n    release:'./$0'\n})\n// \u5904\u7406cs\nfis.match('**/*.scss', {\n    rExt:'.css',\n    parser: fis.plugin('node-sass'),//\u9700\u8981\u5b89\u88c5fis-parser-node-sass\n    optimizer:fis.plugin('clean-css')//\u5185\u7f6e\u63d2\u4ef6\n})\n// \u5904\u7406js\nfis.match('**/*.js', {\n    parser: fis.plugin('babel-6.x'),//\u9700\u8981\u5b89\u88c5fis-parser-babel-6.x\n    optimizer:fis.plugin('uglify-js')//\u5185\u7f6e\u63d2\u4ef6\n})\n")),(0,r.kt)("h2",{id:"gulp\u81ea\u52a8\u5316\u6784\u5efa\u793a\u4f8b\u4ee3\u7801"},"gulp\u81ea\u52a8\u5316\u6784\u5efa\u793a\u4f8b\u4ee3\u7801"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const {\n  src,\n  dest,\n  series,\n  parallel,\n  watch\n} = require('gulp')\nconst loadPlugins = require('gulp-load-plugins')\nconst plugins = loadPlugins()\nconst del = require('del')\nconst bs = require('browser-sync').create()\n\n// \u662f\u5426\u662f\u751f\u4ea7\u73af\u5883\nconst isPro = process.argv[process.argv.length - 1] !== 'dev'\n\nconsole.log(isPro)\nconst config = {\n  input: 'src', //\u5165\u53e3\u6587\u4ef6\u76ee\u5f55\n  output: 'dist', //\u751f\u6210\u6587\u4ef6\u76ee\u5f55\n  temp:'.temp'//\u6587\u4ef6\u4e34\u65f6\u76ee\u5f55\n}\n\n\nconst _src = (path, base) => {\n  return src(`${config.input}/${path}`, {\n    base: base || config.input\n  })\n}\n\n// \u6e05\u9664\u4e0a\u6b21\u751f\u6210\u7684\u6587\u4ef6\nconst clean = () => {\n  return del([config.temp,config.output])\n}\n\n// \u5904\u7406js\u6587\u4ef6\nconst script = () => {\n  return _src('assets/**/*.js')\n    .pipe(plugins.babel({\n      presets: ['@babel/preset-env']\n    }))\n    .pipe(plugins.if(isPro, plugins.uglify()))\n    .pipe(dest(config.temp))\n}\n\n// \u5904\u7406scss\u6587\u4ef6\nconst style = () => {\n  return _src('assets/styles/*.scss')\n    .pipe(plugins.sass({\n      outputStyle: isPro ? 'compressed' : 'nested'\n    }))\n    .pipe(dest(config.temp))\n}\nconst menus = [{\n    name: 'Home',\n    icon: 'aperture',\n    link: 'index.html'\n  },\n  {\n    name: 'Features',\n    link: 'features.html'\n  },\n  {\n    name: 'About',\n    link: 'about.html'\n  },\n  {\n    name: 'Contact',\n    link: '#',\n    children: [{\n        name: 'Twitter',\n        link: 'https://twitter.com/w_zce'\n      },\n      {\n        name: 'About',\n        link: 'https://weibo.com/zceme'\n      },\n      {\n        name: 'divider'\n      },\n      {\n        name: 'About',\n        link: 'https://github.com/zce'\n      }\n    ]\n  }\n]\n// \u5904\u7406html\nconst page = () => {\n  return _src('*.html')\n    .pipe(plugins.swig({\n      data: {\n        pkg: require('./package.json'),\n        date: new Date(),\n        menus: menus\n      }\n    }))\n    // .pipe(\n    //   plugins.if(isPro, plugins.htmlmin({\n    //     collapseWhitespace: true,\n    //     minifyCSS: true,\n    //     minifiJS: true\n    //   }))\n    // )\n    .pipe(dest(config.temp))\n}\n\n// \u5904\u7406 \u56fe\u7247\u3001\u5b57\u4f53\u6587\u4ef6\nconst imageAndFont = () => {\n  return _src('assets/{images,fonts}/*') //\u5904\u7406images\u3001fonts\u4e0b\u7684\u6240\u6709\u6587\u4ef6\n    .pipe(plugins.imagemin())\n    .pipe(dest(config.output))\n}\n//\u5904\u7406public\u76ee\u5f55\nconst public = () => {\n  return src('src/public/**', {\n      base: config.input\n    })\n    .pipe(plugins.imagemin())\n    .pipe(dest(config.output))\n}\n\n// \u5904\u7406\u5f15\u7528\u6587\u4ef6  \u5982bootstrap\nconst useref = () => {\n  return src(`${config.temp}/*.html`, {\n      base: config.temp\n    })\n    .pipe(plugins.useref({\n      searchPath: [config.temp, '.']\n    }))\n    .pipe(\n      plugins.if(/\\.html$/,\n        plugins.htmlmin({\n          collapseWhitespace: true,\n          minifyCSS: true,\n          minifiJS: true\n        })\n      )\n    )\n    .pipe(plugins.if(/\\.js$/,plugins.uglify()))\n    .pipe(dest(config.output))\n}\n\nconst serve = () => {\n  // \u76d1\u542c\u6587\u4ef6\u53d8\u5316\u5e76\u5904\u7406\n  watch(`${config.input}/assets/styles/*.scss`, style)\n  watch(`${config.input}/assets/**/*.js`, script)\n  watch(`${config.input}/*.html`, page)\n\n  //\u5f00\u53d1\u73af\u5883\u4e0d\u9700\u8981\u5904\u7406\u56fe\u7247\u7b49\u6587\u4ef6\u7684\u538b\u7f29\uff0c\u76f4\u63a5\u5237\u65b0\n  watch([\n    `${config.input}/assets/{images,fonts}/*`,\n    `${config.input}/public/**`\n  ], bs.reload)\n\n  bs.init({\n    open: false, //\u542f\u52a8\u65f6\u662f\u5426\u6253\u5f00\u6d4f\u89c8\u5668\n    notify: false,\n    files: `${config.temp}/**`, //\u76d1\u542c\u6587\u4ef6\u53d8\u5316\n    server: {\n      baseDir: [config.temp, 'src', '.'] //\u6587\u4ef6\u52a0\u8f7d\u5730\u5740\uff08\u5148\u52a0\u8f7ddist\u76ee\u5f55\uff0c\u5982\u679cdist\u76ee\u5f55\u4e0d\u5b58\u5728\u8be5\u6587\u4ef6\uff0c\u4f1a\u5230src\u76ee\u5f55\u6587\u4ef6,src\u627e\u4e0d\u5230\uff0c\u4f1a\u5230\u5f53\u524d\u76ee\u5f55\uff09\n    }\n  })\n}\n\nconst compile = parallel(script, style, page)\nconst build = series(\n  clean,\n  parallel(\n    series(compile, useref),\n    imageAndFont,\n    public\n  )\n)\nconst dev = series(compile, serve)\nmodule.exports = {\n  script,\n  style,\n  page,\n  imageAndFont,\n  public,\n  useref,\n  clean,\n  compile,\n  build,\n  dev\n}\n\n")))}d.isMDXComponent=!0}}]);